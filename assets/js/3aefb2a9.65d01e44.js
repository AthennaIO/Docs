"use strict";(self.webpackChunk_athenna_docs=self.webpackChunk_athenna_docs||[]).push([[7336],{2242:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"rest-api-application/routing","title":"Routing","description":"Understand how you can set up routes for your REST API application.","source":"@site/docs/rest-api-application/routing.mdx","sourceDirName":"rest-api-application","slug":"/rest-api-application/routing","permalink":"/docs/rest-api-application/routing","draft":false,"unlisted":false,"editUrl":"https://github.com/AthennaIO/Docs/tree/main/docs/rest-api-application/routing.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Routing","sidebar_position":1,"description":"Understand how you can set up routes for your REST API application."},"sidebar":"tutorialSidebar","previous":{"title":"Library Development","permalink":"/docs/digging-deeper/library-development"},"next":{"title":"Middlewares","permalink":"/docs/rest-api-application/middlewares"}}');var n=t(4848),o=t(8453),i=t(7049);const a={title:"Routing",sidebar_position:1,description:"Understand how you can set up routes for your REST API application."},c="Routing",d={},l=[{value:"Basic routing",id:"basic-routing",level:2},{value:"Available Router Methods",id:"available-router-methods",level:3},{value:"View routes",id:"view-routes",level:2},{value:"Redirect routes",id:"redirect-routes",level:2},{value:"The route list",id:"the-route-list",level:2},{value:"Route parameters",id:"route-parameters",level:2},{value:"Route groups",id:"route-groups",level:2},{value:"Middleware",id:"middleware",level:3},{value:"Route prefixes",id:"route-prefixes",level:3},{value:"Cross-origin resource sharing (CORS)",id:"cross-origin-resource-sharing-cors",level:2},{value:"Custom route file path",id:"custom-route-file-path",level:2}];function h(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"routing",children:"Routing"})}),"\n",(0,n.jsx)(r.p,{children:"Understand how you can set up routes for your REST API\napplication."}),"\n",(0,n.jsx)(r.h2,{id:"basic-routing",children:"Basic routing"}),"\n",(0,n.jsx)(r.p,{children:"The most basic Athenna routes accept an url and a closure,\nproviding a basic and expressive method of defining routes\nand behavior without complicated routing configuration\nfiles:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"import { Route } from '@athenna/http' // Route Facade\n\nRoute.get('/welcome', ({ response }) => {\n    return response.status(200).send({ hello: 'world' })\n})\n"})}),"\n",(0,n.jsx)(r.h3,{id:"available-router-methods",children:"Available Router Methods"}),"\n",(0,n.jsx)(r.p,{children:"The router allows you to register routes that respond to\nany HTTP verb:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.get(url, callback)\nRoute.post(url, callback)\nRoute.put(url, callback)\nRoute.patch(url, callback)\nRoute.delete(url, callback)\nRoute.options(url, callback)\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Sometimes you may need to register a route that responds to\nmultiple HTTP verbs. You may do so using the ",(0,n.jsx)(r.code,{children:"any"})," method\nto respond to all HTTP verbs:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.any('/', () => {\n    //\n})\n"})}),"\n",(0,n.jsx)(r.admonition,{type:"tip",children:(0,n.jsxs)(r.p,{children:["When defining multiple routes that share the same ",(0,n.jsx)(r.code,{children:"url"}),",\nroutes using the ",(0,n.jsx)(r.code,{children:"get"}),", ",(0,n.jsx)(r.code,{children:"post"}),", ",(0,n.jsx)(r.code,{children:"put"}),", ",(0,n.jsx)(r.code,{children:"patch"}),", ",(0,n.jsx)(r.code,{children:"delete"}),",\nand ",(0,n.jsx)(r.code,{children:"options"})," methods should be defined before routes\nusing the ",(0,n.jsx)(r.code,{children:"any"})," and ",(0,n.jsx)(r.code,{children:"redirect"})," methods. This ensures the\nincoming request is matched with the correct route."]})}),"\n",(0,n.jsx)(r.h2,{id:"view-routes",children:"View routes"}),"\n",(0,n.jsxs)(r.p,{children:["You may use the ",(0,n.jsx)(r.code,{children:"Route.view()"})," method if you have a route handler\nthat only renders a view. It is a convenient shortcut to render\na view without defining an explicit handler:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.view('/welcome', 'welcome')\n"})}),"\n",(0,n.jsx)(r.p,{children:"The example above is just a shortcut for the following:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.get('/welcome', ({ response }) => {\n  return response.view('welcome')\n})\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Optionally, you can pass the template data as the third argument,\njust like in ",(0,n.jsx)(r.code,{children:"response.view()"})," method:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.view('/welcome', 'welcome', { name: 'lenon' })\n"})}),"\n",(0,n.jsx)(r.h2,{id:"redirect-routes",children:"Redirect routes"}),"\n",(0,n.jsxs)(r.p,{children:["If you are defining a route that redirects to another\n",(0,n.jsx)(r.code,{children:"url"}),", you may use the ",(0,n.jsx)(r.code,{children:"Route.redirect()"})," method. This\nmethod provides a convenient shortcut so that you do not\nhave to define a full route or controller for performing\na simple redirect:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.redirect('/here', '/there')\n"})}),"\n",(0,n.jsxs)(r.p,{children:["By default, ",(0,n.jsx)(r.code,{children:"Route.redirect()"})," method returns a ",(0,n.jsx)(r.code,{children:"302"}),"\nstatus code. You may customize the status code using\nthe optional third parameter:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.redirect('/here', '/there', 301)\n"})}),"\n",(0,n.jsx)(r.h2,{id:"the-route-list",children:"The route list"}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"route:list"})," command can easily provide an overview of all the routes that are defined by your application:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"node artisan route:list\n"})}),"\n",(0,n.jsxs)(r.p,{children:["By default, the route middleware that are assigned to each\nroute will not be displayed in the ",(0,n.jsx)(r.code,{children:"route:list"})," output;\nhowever, you can instruct Athenna to display the route\nmiddleware by adding the ",(0,n.jsx)(r.code,{children:"-m, --middleware"})," option to the\ncommand:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"node artisan route:list --middleware\n"})}),"\n",(0,n.jsx)(r.h2,{id:"route-parameters",children:"Route parameters"}),"\n",(0,n.jsx)(r.p,{children:"Sometimes you will need to capture segments of the URL\nwithin your route. For example, you may need to capture\na user's ID from the URL. You may do so by defining route\nparameters:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.get('/user/:id', ({ request, response }) => {\n    return response.send({ user: `User ${request.param('id')}` })\n})\n"})}),"\n",(0,n.jsx)(r.p,{children:"You may define as many route parameters as required by\nyour route:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.get('/posts/:postId/comments/:commentId', ({ response, params }) => {\n    return response.send({ params })\n})\n"})}),"\n",(0,n.jsx)(r.h2,{id:"route-groups",children:"Route groups"}),"\n",(0,n.jsx)(r.p,{children:"Route groups allow you to share route attributes, such as\nmiddleware, across a large number of routes without\nneeding to define those attributes on each route."}),"\n",(0,n.jsx)(r.h3,{id:"middleware",children:"Middleware"}),"\n",(0,n.jsxs)(r.p,{children:["To assign ",(0,n.jsx)(r.a,{href:"/docs/the-basics/http/middlewares",children:(0,n.jsx)(r.code,{children:"middlewares"})}),"\nto all routes within a group, you may use the ",(0,n.jsx)(r.code,{children:"middleware"}),"\nmethod before defining the group. Middleware is executed\nin the order they are listed in the array:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.group(() => {\n    Route.get('/', () => {\n        // Uses first & second middleware...\n    })\n\n    Route.get('/user/profile', () => {\n        // Uses first & second middleware...\n    })\n}).middleware(['first', 'second'])\n"})}),"\n",(0,n.jsx)(r.h3,{id:"route-prefixes",children:"Route prefixes"}),"\n",(0,n.jsxs)(r.p,{children:["The prefix method may be used to prefix each route in the\ngroup with a given URL. For example, you may want to prefix\nall route URLs within the group with ",(0,n.jsx)(r.code,{children:"admin"}),":"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"Route.group(() => {\n    Route.get('/users', () => {\n        // Matches only the \"/admin/users\" URL\n    })\n}).prefix('admin')\n"})}),"\n",(0,n.jsx)(r.h2,{id:"cross-origin-resource-sharing-cors",children:"Cross-origin resource sharing (CORS)"}),"\n",(0,n.jsx)(r.p,{children:"Cross-Origin Resource Sharing (CORS) is an HTTP-header\nbased mechanism that allows a server to indicate any\norigins (domain, scheme, or port) other than its own from\nwhich a browser should permit loading resources."}),"\n",(0,n.jsxs)(r.p,{children:["Athenna uses the ",(0,n.jsx)(r.a,{href:"https://github.com/fastify/fastify-cors",children:(0,n.jsx)(r.code,{children:"@fastify/cors"})}),"\nplugin inside ",(0,n.jsx)(r.code,{children:"HttpKernel"}),". All the configurations that\n",(0,n.jsx)(r.code,{children:"@fastify/cors"})," supports can be set inside ",(0,n.jsx)(i.A,{father:"config",child:"http.ts"}),"\nfile in the ",(0,n.jsx)(r.code,{children:"cors"})," object."]}),"\n",(0,n.jsxs)(r.p,{children:["Cors plugin is registered in your http application by\ndefault, but you can remove it uninstalling ",(0,n.jsx)(r.code,{children:"@fastify/cors"}),"\nfrom your application, or removing the ",(0,n.jsx)(r.code,{children:"cors"})," object key\nfrom your ",(0,n.jsx)(i.A,{father:"config",child:"http.ts"})," file."]}),"\n",(0,n.jsx)(r.admonition,{type:"tip",children:(0,n.jsxs)(r.p,{children:["For more information on CORS and CORS headers, please\nconsult the ",(0,n.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",children:"MDN web documentation on CORS"}),"."]})}),"\n",(0,n.jsx)(r.h2,{id:"custom-route-file-path",children:"Custom route file path"}),"\n",(0,n.jsxs)(r.p,{children:["You can change the name and the path of your ",(0,n.jsx)(i.A,{father:"routes",child:"http.ts"})," file.\nTo do that you need to set the new path to ",(0,n.jsx)(r.code,{children:"Ignite.httpServer()"})," method:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",metastring:"title=\"Path.bin('dev.ts')\"",children:"import { Ignite } from '@athenna/core'\n\nconst ignite = await new Ignite().load(import.meta.url)\n\nawait ignite.httpServer({\n  routePath: './bootstrap/routes/http-dev.js' \ud83d\udc48\n})\n"})}),"\n",(0,n.jsx)(r.admonition,{type:"tip",children:(0,n.jsx)(r.p,{children:"Always remember that when using relative paths to set something\nin Athenna, you need to use your project root path as reference,\njust like in the example above."})})]})}function u(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},7049:(e,r,t)=>{t.d(r,{A:()=>o});t(6540);const s={hoverCardContainer:"hoverCardContainer_jqUQ",hoverCardLink:"hoverCardLink_oDZU",hoverCard:"hoverCard_qTDS"};var n=t(4848);function o(e){let r=e.father;switch(e.father){case"storage":r="src/storage";break;case"logs":r="src/storage/logs";break;case"views":r="src/resources/views";break;case"locales":r="src/resources/locales";break;case"static":r="src/resources/static";break;case"config":r="src/config";break;case"database":r="src/database";break;case"seeders":r="src/database/seeders";break;case"migrations":r="src/database/migrations";break;case"console":r="src/console";break;case"commands":r="src/console/commands";break;case"cron":r="src/cron";break;case"schedulers":r="src/cron/schedulers";break;case"models":r="src/models";break;case"services":r="src/services";break;case"repositories":r="src/repositories";break;case"http":r="src/http";break;case"controllers":r="src/http/controllers";break;case"middlewares":r="src/http/middlewares";break;case"interceptors":r="src/http/interceptors";break;case"terminators":r="src/http/terminators";break;case"stubs":r="tests/stubs";break;case"fixtures":r="tests/fixtures";break;case"providers":r="src/providers";break;case"facades":r="src/facades";break;case"routes":r="src/routes"}return(0,n.jsxs)("div",{className:s.hoverCardContainer,children:[(0,n.jsx)("a",{className:s.hoverCardLink,href:`/docs/the-basics/helpers#path${e.father}`,children:(0,n.jsxs)("code",{children:["Path.",e.father,"(",e.child?`'${e.child}'`:"",")"]})}),(0,n.jsx)("div",{className:s.hoverCard,children:(0,n.jsxs)("p",{style:{margin:0},children:["./",r,e.child?`/${e.child}`:""]})})]})}},8453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>a});var s=t(6540);const n={},o=s.createContext(n);function i(e){const r=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(o.Provider,{value:r},e.children)}}}]);