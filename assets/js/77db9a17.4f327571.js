"use strict";(self.webpackChunk_athenna_docs=self.webpackChunk_athenna_docs||[]).push([[2628],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>g});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=o.createContext({}),s=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=s(e.components);return o.createElement(p.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=s(n),u=r,g=c["".concat(p,".").concat(u)]||c[u]||d[u]||a;return n?o.createElement(g,i(i({ref:t},m),{},{components:n})):o.createElement(g,i({ref:t},m))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},1648:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var o=n(7462),r=(n(7294),n(3905));const a={title:"REPL",sidebar_position:1,description:"See how to create a REPL session with Athenna Framework ecosystem."},i="REPL",l={unversionedId:"digging-deeper/repl",id:"digging-deeper/repl",title:"REPL",description:"See how to create a REPL session with Athenna Framework ecosystem.",source:"@site/docs/digging-deeper/repl.mdx",sourceDirName:"digging-deeper",slug:"/digging-deeper/repl",permalink:"/docs/digging-deeper/repl",draft:!1,editUrl:"https://github.com/AthennaIO/Docs/tree/main/docs/digging-deeper/repl.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"REPL",sidebar_position:1,description:"See how to create a REPL session with Athenna Framework ecosystem."},sidebar:"tutorialSidebar",previous:{title:"Digging Deeper",permalink:"/docs/digging-deeper"},next:{title:"Graceful Shutdown",permalink:"/docs/digging-deeper/graceful-shutdown"}},p={},s=[{value:"Introduction",id:"introduction",level:2},{value:"Booting REPL",id:"booting-repl",level:2},{value:"Importing modules in REPL session",id:"importing-modules-in-repl-session",level:2},{value:"Extending REPL Context",id:"extending-repl-context",level:2},{value:"Custom REPL commands",id:"custom-repl-commands",level:2},{value:"Pre-importing modules",id:"pre-importing-modules",level:2},{value:"Pre-importing module",id:"pre-importing-module",level:3},{value:"Pre-importing modules names as keys",id:"pre-importing-modules-names-as-keys",level:3}],m={toc:s},c="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"repl"},"REPL"),(0,r.kt)("p",null,"See how to create a REPL session with Athenna Framework ecosystem."),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"From ",(0,r.kt)("a",{parentName:"p",href:"https://www.digitalocean.com/community/tutorials/what-is-repl"},"Digital ocean article"),":\nA Read-Eval-Print Loop, or REPL, is a computer environment\nwhere user inputs are read and evaluated, and then the results\nare returned to the user. REPLs provide an interactive\nenvironment to explore tools available in specific environments\nor programming languages. Some examples include the Node.js\nconsole, IPython, the Bash shell, and the developer console\nfound in most web browsers."),(0,r.kt)("p",null,"Athenna can easily integrate with\n",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/api/repl.html#repl"},(0,r.kt)("inlineCode",{parentName:"a"},"node:repl"))," package\nto run your entire infrastructure in parallel with the package."),(0,r.kt)("h2",{id:"booting-repl"},"Booting REPL"),(0,r.kt)("p",null,"REPL allows you to interact with your entire Athenna\napplication on the command line, including your models,\njobs, events, and more. To enter the REPL environment,\nrun the Artisan command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"node artisan repl\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"When running this command, Athenna will use the\n",(0,r.kt)("inlineCode",{parentName:"p"},"Path.bootstrap('repl.ts')")," file to execute your session.")),(0,r.kt)("h2",{id:"importing-modules-in-repl-session"},"Importing modules in REPL session"),(0,r.kt)("p",null,"To import modules inside REPL you need to use dynamic imports:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"{ Log } = await import('@athenna/logger') // Destructuring import\nhelpers = await import('#app/helpers/index') // Default import\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"If you don't use ",(0,r.kt)("inlineCode",{parentName:"p"},"var/let/const")," in front of your importation,\nthe variable will be set globally in your REPL session.")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"You can check the global context of your REPL session\nrunning ",(0,r.kt)("inlineCode",{parentName:"p"},".ls"),". You can type ",(0,r.kt)("inlineCode",{parentName:"p"},".help")," to check all REPL\ncommands available.")),(0,r.kt)("h2",{id:"extending-repl-context"},"Extending REPL Context"),(0,r.kt)("p",null,"When running your REPL session, it could be painful to\nkeep declaring the same variables over and over again. To\navoid that you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"repl.setIntContext()")," method,\nand it will be available in all your REPL sessions:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"title=\"Path.bootstrap('repl.ts')\"",title:"\"Path.bootstrap('repl.ts')\""},"import { Ignite } from '@athenna/core'\n\nconst ignite = await new Ignite().load(import.meta.url, { bootLogs: false })\n\nconst repl = await ignite.repl()\n\nrepl.setInContext('helloWorld', 'Hello World!')\nrepl.setInContext('appService', ioc.safeUse('App/Services/AppService'))\n")),(0,r.kt)("h2",{id:"custom-repl-commands"},"Custom REPL commands"),(0,r.kt)("p",null,"You can create custom REPL commands like ",(0,r.kt)("inlineCode",{parentName:"p"},".ls")," and ",(0,r.kt)("inlineCode",{parentName:"p"},".clean"),"\nto make your life easier when running your REPL session:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"title=\"Path.bootstrap('repl.ts')\"",title:"\"Path.bootstrap('repl.ts')\""},"import { Ignite } from '@athenna/core'\n\nconst ignite = await new Ignite().load(import.meta.url, { bootLogs: false })\n\nconst repl = await ignite.repl()\n\nrepl\n    .command('greet')\n    .help('Greet someone')\n    .action(function action(name: string) {\n        this.clearBufferedCommand()\n        console.log(`Hello ${name}!`)\n        this.displayPrompt()\n    })\n    .register()\n")),(0,r.kt)("p",null,"Now the ",(0,r.kt)("inlineCode",{parentName:"p"},".greet")," command will always be available in your\nREPL sessions:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},".greet Antoine\n> Hello Antoine!\n")),(0,r.kt)("h2",{id:"pre-importing-modules"},"Pre-importing modules"),(0,r.kt)("h3",{id:"pre-importing-module"},"Pre-importing module"),(0,r.kt)("p",null,"Like declaring variables in the REPL context, it could be painful\nto import modules in your everytime in your REPL sessions. To avoid\nit you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"repl.import()")," method:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Ignite } from '@athenna/core'\n\nconst ignite = await new Ignite().load(import.meta.url, { bootLogs: false })\n\nconst repl = await ignite.repl()\n\nawait repl.import('common', '@athenna/common')\n")),(0,r.kt)("p",null,"Now you are able to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"common")," variable in your REPL sessions:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"common.Path.pwd()\n")),(0,r.kt)("h3",{id:"pre-importing-modules-names-as-keys"},"Pre-importing modules names as keys"),(0,r.kt)("p",null,"Sometimes a module exports a variety of classes, functions, etc.\nLike ",(0,r.kt)("inlineCode",{parentName:"p"},"@athenna/common"),", that exports a variety of helpers, and would\nbe easier if we could directly use the helper name instead\nof the ",(0,r.kt)("inlineCode",{parentName:"p"},"common")," variable as we have created in the example above.\nWith ",(0,r.kt)("inlineCode",{parentName:"p"},"repl.importAll()")," you can import the module names as keys to\nthe REPL context:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Ignite } from '@athenna/core'\n\nconst ignite = await new Ignite().load(import.meta.url, { bootLogs: false })\n\nconst repl = await ignite.repl()\n\nawait repl.importAll('@athenna/common')\n")),(0,r.kt)("p",null,"Now you are able to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"Path")," helper directly in your REPL sessions:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"Path.pwd()\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"By default, your ",(0,r.kt)("inlineCode",{parentName:"p"},"Path.bootstrap('repl.ts')")," file already\nimports all the ",(0,r.kt)("inlineCode",{parentName:"p"},"@athenna/common")," helpers to your REPL session \ud83e\udd29.")))}d.isMDXComponent=!0}}]);