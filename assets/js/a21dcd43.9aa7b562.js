"use strict";(self.webpackChunk_athenna_docs=self.webpackChunk_athenna_docs||[]).push([[8813],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(n),m=s,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=n.length,o=new Array(r);o[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:s,o[1]=i;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9736:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var a=n(7462),s=(n(7294),n(3905));const r={title:"Getting Started",sidebar_position:1,description:"See how to create tests in an Athenna application."},o="Getting Started",i={unversionedId:"testing/getting-started",id:"testing/getting-started",title:"Getting Started",description:"See how to create tests in an Athenna application.",source:"@site/docs/testing/getting-started.mdx",sourceDirName:"testing",slug:"/testing/getting-started",permalink:"/docs/testing/getting-started",draft:!1,editUrl:"https://github.com/AthennaIO/Docs/tree/main/docs/testing/getting-started.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Getting Started",sidebar_position:1,description:"See how to create tests in an Athenna application."},sidebar:"tutorialSidebar",previous:{title:"Testing",permalink:"/docs/testing"},next:{title:"REST API Testing",permalink:"/docs/testing/rest-api-testing"}},l={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Environment",id:"environment",level:2},{value:"Writing tests",id:"writing-tests",level:2},{value:"Tests structure",id:"tests-structure",level:2},{value:"<code>@Test()</code>",id:"test",level:3},{value:"<code>@BeforeAll()</code>",id:"beforeall",level:3},{value:"<code>@BeforeEach()</code>",id:"beforeeach",level:3},{value:"<code>@AfterAll()</code>",id:"afterall",level:3},{value:"<code>@AfterEach()</code>",id:"aftereach",level:3},{value:"Running tests",id:"running-tests",level:2},{value:"Assertions",id:"assertions",level:2},{value:"Other useful annotations",id:"other-useful-annotations",level:2},{value:"Reporting test coverage",id:"reporting-test-coverage",level:2},{value:"Creating base test classes",id:"creating-base-test-classes",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,s.kt)(u,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"getting-started"},"Getting Started"),(0,s.kt)("p",null,"See how to create tests in an Athenna application."),(0,s.kt)("h2",{id:"introduction"},"Introduction"),(0,s.kt)("p",null,"Athenna is built with testing in mind. In fact,\nsupport for testing with ",(0,s.kt)("a",{parentName:"p",href:"https://japa.dev"},"Japa")," is included out\nof the box. The framework also ships with convenient\nhelper methods that allow you to expressively test\nyour applications."),(0,s.kt)("p",null,"By default, your application's ",(0,s.kt)("inlineCode",{parentName:"p"},"tests")," directory\ncontains four directories: "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"e2e")," - Should contains the tests responsible to test\na larger portion of your code, including how several\nobject interact with each other or even a full HTTP\nrequest to a JSON endpoint."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"unit")," - Should contains the tests responsible to test\nisolated portion of your code, focusing on a single method.\nTests within your ",(0,s.kt)("strong",{parentName:"li"},"unit")," test directory should not boot\nyour Athenna application, meaning that they should be unable\nto access your application's database or other framework\nservices.")),(0,s.kt)("p",null,"An ",(0,s.kt)("inlineCode",{parentName:"p"},"e2e/AppControllerTest.ts")," and\n",(0,s.kt)("inlineCode",{parentName:"p"},"unit/AppServiceTest.ts")," files is provided for you\nto use as an example to start writing your own tests. After\ninstalling a new Athenna application, execute the following\nto run your tests:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"./node artisan test\n")),(0,s.kt)("h2",{id:"environment"},"Environment"),(0,s.kt)("p",null,"When running tests, Athenna will automatically set the\n",(0,s.kt)("a",{parentName:"p",href:"/docs/getting-started/configuration"},"configuration environment"),"\nto ",(0,s.kt)("inlineCode",{parentName:"p"},"test"),", meaning that the ",(0,s.kt)("inlineCode",{parentName:"p"},".env.test")," file will be used when\nrunning your tests."),(0,s.kt)("p",null,"You are free to define other testing environment value. To do\nthat you can use the ",(0,s.kt)("inlineCode",{parentName:"p"},"setNodeEnv()")," method of ",(0,s.kt)("inlineCode",{parentName:"p"},"Runner")," class\nin your ",(0,s.kt)("inlineCode",{parentName:"p"},"Path.bootstrap('test.ts')")," file:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Runner } from '@athenna/test'\nimport { request } from '@athenna/http/testing/plugins'\nimport { command } from '@athenna/artisan/testing/plugins'\n\nawait Runner.setTsEnv()\n  .addPlugin(assert())\n  .addPlugin(request())\n  .addPlugin(command())\n  .setNodeEnv('testing') \ud83d\udc48\n  .addReporter(specReporter())\n  .addPath('tests/e2e/**/*.ts')\n  .addPath('tests/unit/**/*.ts')\n  .setCliArgs(process.argv.slice(2))\n  .setGlobalTimeout(5000)\n  .run()\n")),(0,s.kt)("h2",{id:"writing-tests"},"Writing tests"),(0,s.kt)("p",null,"To create a new test case, use the ",(0,s.kt)("inlineCode",{parentName:"p"},"make:test")," Artisan\ncommand. By default, tests will be placed in the ",(0,s.kt)("inlineCode",{parentName:"p"},"tests/e2e"),"\ndirectory:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"./node artisan make:test UserTest\n")),(0,s.kt)("p",null,"If you would like to create a test within the ",(0,s.kt)("inlineCode",{parentName:"p"},"tests/unit"),"\ndirectory, you may use the ",(0,s.kt)("inlineCode",{parentName:"p"},"--unit")," option when executing\nthe ",(0,s.kt)("inlineCode",{parentName:"p"},"make:test")," command:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"./node artisan make:test UserTest --unit\n")),(0,s.kt)("admonition",{type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"You can also create a custom test for each specific\nAthenna application:"),(0,s.kt)("pre",{parentName:"admonition"},(0,s.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title="For REST API"',title:'"For',REST:!0,'API"':!0},"./node artisan make:test UserTest --rest\n")),(0,s.kt)("pre",{parentName:"admonition"},(0,s.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title="For CLI"',title:'"For','CLI"':!0},"./node artisan make:test UserTest --cli\n")),(0,s.kt)("p",{parentName:"admonition"},"To customize the test templates check the\n",(0,s.kt)("a",{parentName:"p",href:"/docs/the-basics/views#customizing-make-commands-templates"},(0,s.kt)("inlineCode",{parentName:"a"},"template:customize")),"\ncommand.")),(0,s.kt)("p",null,"Oce the test has been generated, you may define your\ntest methods and annotate them with the ",(0,s.kt)("inlineCode",{parentName:"p"},"@Test()")," annotation:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Test, type Context } from '@athenna/test'\n\nexport default class ExampleTest {\n  @Test()\n  public async testBasicExample({ assert }: Context) {\n    assert.equal(1 + 1, 2)\n  }\n}\n")),(0,s.kt)("h2",{id:"tests-structure"},"Tests structure"),(0,s.kt)("p",null,"Athenna tests are represented as classes. Your class name will\nbe used as the test suite name, while the test methods will be\nconsidered the test names. All the methods of the class are\ncustomizable, what defines if that method is a test, test hook\nor even a helper method is the annotation used:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"import { \n  Test, \n  BeforeAll, \n  BeforeEach, \n  AfterAll, \n  AfterEach, \n  type Context \n} from '@athenna/test'\n\nexport default class SumTest {\n  public sum(a: number, b: number): number {\n    return a + b\n  }\n\n  @BeforeAll()\n  public async beforeAll() {\n    //\n  }\n\n  @AfterAll()\n  public async afterAll() {\n    //\n  }\n\n  @BeforeEach()\n  public async beforeEach() {\n    //\n  }\n\n  @AfterEach()\n  public async afterEach() {\n    //\n  }\n\n  @Test()\n  public async 'should be considered a test!' ({ assert }: Context) {\n    assert.equal(this.sum(1, 1), 2)\n  }\n}\n")),(0,s.kt)("h3",{id:"test"},(0,s.kt)("inlineCode",{parentName:"h3"},"@Test()")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"@Test()")," annotation is used to define a method\nas a test:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"@Test()\npublic async testMethod({ assert }: Context) {\n  assert.equal(1 + 1, 2)\n}\n")),(0,s.kt)("p",null,"You can also define the test name by passing a string\nto the ",(0,s.kt)("inlineCode",{parentName:"p"},"@Test()")," annotation:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"@Test('test method!')\npublic async testMethod({ assert }: Context) {\n  assert.equal(1 + 1, 2)\n}\n")),(0,s.kt)("admonition",{type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"This could also be done in class defining the\nmethod name as string:"),(0,s.kt)("pre",{parentName:"admonition"},(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"@Test()\npublic async 'test method!' ({ assert }: Context) {\n  assert.equal(1 + 1, 2)\n}\n"))),(0,s.kt)("h3",{id:"beforeall"},(0,s.kt)("inlineCode",{parentName:"h3"},"@BeforeAll()")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"@BeforeAll()")," annotation is used to define that a\nmethod should be executed ",(0,s.kt)("strong",{parentName:"p"},"before all")," tests of that class\n",(0,s.kt)("strong",{parentName:"p"},"starts running"),". You can define as many as you want in the\nsame class:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"@BeforeAll()\npublic async doSomeOp() {\n  //\n}\n\n@BeforeAll()\npublic async doOtherOp() {\n  //\n}\n")),(0,s.kt)("h3",{id:"beforeeach"},(0,s.kt)("inlineCode",{parentName:"h3"},"@BeforeEach()")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"@BeforeEach()")," annotation is used to define that a\nmethod should be executed ",(0,s.kt)("strong",{parentName:"p"},"before each")," tests of that class\n",(0,s.kt)("strong",{parentName:"p"},"starts running"),". You can define as many as you want in the\nsame class:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"@BeforeEach()\npublic async doSomeOp() {\n  //\n}\n\n@BeforeEach()\npublic async doOtherOp() {\n  //\n}\n")),(0,s.kt)("h3",{id:"afterall"},(0,s.kt)("inlineCode",{parentName:"h3"},"@AfterAll()")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"@AfterAll()")," annotation is used to define that a\nmethod should be executed ",(0,s.kt)("strong",{parentName:"p"},"after all")," tests of that class\n",(0,s.kt)("strong",{parentName:"p"},"ends running"),". You can define as many as you want in the\nsame class:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"@AfterAll()\npublic async doSomeOp() {\n  //\n}\n\n@AfterAll()\npublic async doOtherOp() {\n  //\n}\n")),(0,s.kt)("h3",{id:"aftereach"},(0,s.kt)("inlineCode",{parentName:"h3"},"@AfterEach()")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"@AfterEach()")," annotation is used to define that a\nmethod should be executed ",(0,s.kt)("strong",{parentName:"p"},"after each")," tests of that class\n",(0,s.kt)("strong",{parentName:"p"},"ends running"),". You can define as many as you want in the\nsame class:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"@AfterEach()\npublic async doSomeOp() {\n  //\n}\n\n@AfterEach()\npublic async doOtherOp() {\n  //\n}\n")),(0,s.kt)("h2",{id:"running-tests"},"Running tests"),(0,s.kt)("p",null,"To run your tests you can use the ",(0,s.kt)("inlineCode",{parentName:"p"},"test")," Artisan command:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"./node artisan test\n")),(0,s.kt)("p",null,"Any arguments that can be passed to ",(0,s.kt)("a",{parentName:"p",href:"https://japa.dev"},"Japa"),",\nmay also be passed to the Artisan ",(0,s.kt)("inlineCode",{parentName:"p"},"test")," command:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},'./node artisan test --groups="MyClassTest" --force-exit\n')),(0,s.kt)("h2",{id:"assertions"},"Assertions"),(0,s.kt)("p",null,"Athenna ships with a variety of helpful assertions with the\nhelp of the ",(0,s.kt)("a",{parentName:"p",href:"https://japa.dev/docs/plugins/assert"},(0,s.kt)("inlineCode",{parentName:"a"},"@japa/assert")),"\nplugin. We are not going to cover\nthe assertions here, but you can check the ",(0,s.kt)("a",{parentName:"p",href:"https://japa.dev/docs/plugins/assert#assert-1"},"assert documentation\nsection")," of Japa to\nsee all the available methods for you."),(0,s.kt)("p",null,"Their documentation is beautiful, small and precise. I swear it\nwill be worth your time \ud83d\ude0e."),(0,s.kt)("h2",{id:"other-useful-annotations"},"Other useful annotations"),(0,s.kt)("p",null,"Coming soon"),(0,s.kt)("h2",{id:"reporting-test-coverage"},"Reporting test coverage"),(0,s.kt)("p",null,"Coming soon"),(0,s.kt)("h2",{id:"creating-base-test-classes"},"Creating base test classes"),(0,s.kt)("p",null,"Coming soon"))}d.isMDXComponent=!0}}]);