"use strict";(self.webpackChunk_athenna_docs=self.webpackChunk_athenna_docs||[]).push([[6606],{9621:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"rest-api-application/web-application","title":"Web Application","description":"See how to create web applications using Vite for asset bundling.","source":"@site/docs/rest-api-application/web-application.mdx","sourceDirName":"rest-api-application","slug":"/rest-api-application/web-application","permalink":"/docs/rest-api-application/web-application","draft":false,"unlisted":false,"editUrl":"https://github.com/AthennaIO/Docs/tree/main/docs/rest-api-application/web-application.mdx","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"title":"Web Application","sidebar_position":13,"description":"See how to create web applications using Vite for asset bundling."},"sidebar":"tutorialSidebar","previous":{"title":"Static Files","permalink":"/docs/rest-api-application/static-files"},"next":{"title":"Commands","permalink":"/docs/cli-application/commands"}}');var s=n(4848),r=n(8453),a=n(7049);const o={title:"Web Application",sidebar_position:13,description:"See how to create web applications using Vite for asset bundling."},l="Web Application",c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Installing",id:"installing",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Vite configuration file",id:"vite-configuration-file",level:3},{value:"entrypoints",id:"entrypoints",level:4},{value:"buildDirectory",id:"builddirectory",level:4},{value:"reload",id:"reload",level:4},{value:"assetsUrl",id:"assetsurl",level:4},{value:"Vite backend configuration",id:"vite-backend-configuration",level:3},{value:"dev",id:"dev",level:4},{value:"buildDirectory",id:"builddirectory-1",level:4},{value:"assetsUrl",id:"assetsurl-1",level:4},{value:"scriptAttributes",id:"scriptattributes",level:4},{value:"styleAttributes",id:"styleattributes",level:4},{value:"Starting the dev server",id:"starting-the-dev-server",level:2},{value:"Including entrypoints in Edge templates",id:"including-entrypoints-in-edge-templates",level:2},{value:"Referencing assets inside Edge templates",id:"referencing-assets-inside-edge-templates",level:2},{value:"Processing additional assets with Vite",id:"processing-additional-assets-with-vite",level:2},{value:"Enabling HMR with React",id:"enabling-hmr-with-react",level:2},{value:"Deploying assets to a CDN",id:"deploying-assets-to-a-cdn",level:2},{value:"Manifest file",id:"manifest-file",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"web-application",children:"Web Application"})}),"\n",(0,s.jsx)(t.p,{children:"See how to create web applications using Vite for asset bundling."}),"\n",(0,s.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://vite.dev/",children:"Vite"})," is a modern frontend build tool that provides\nan extremely fast development environment and bundles your code\nfor production. When building applications with Athenna, you will\ntypically use Vite to bundle your application's CSS and JavaScript\nfiles into production ready assets."]}),"\n",(0,s.jsxs)(t.p,{children:["Athenna integrates seamlessly with Vite by providing an official\nplugin and ",(0,s.jsx)(t.a,{href:"https://edgejs.dev/docs/introduction",children:"Edge.js"})," directive\nto load your assets for development and production. This tool facilitates\nthe development of full-stack web applications using Athenna as the backend\nframework."]}),"\n",(0,s.jsx)(t.h2,{id:"installing",children:"Installing"}),"\n",(0,s.jsx)(t.p,{children:"We recommend to start a new Athenna project to setup all the\nconfigurations needed to get Athenna + Vite working together:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"athenna new my-web-app\n"})}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["Don't forget to select ",(0,s.jsx)(t.code,{children:"WEB EDGE"})," or ",(0,s.jsx)(t.code,{children:"WEB REACT"})," when prompted about the\napplication type."]})}),"\n",(0,s.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(t.p,{children:["The web application adds the ",(0,s.jsx)(t.code,{children:"vite.config.ts"})," file that is used to\nconfigure the Vite bundler, and a new plugin to\n",(0,s.jsx)(a.A,{father:"config",child:"http.ts"})," named ",(0,s.jsx)(t.code,{children:"vite"})," that is used\nby Athenna on the backend."]}),"\n",(0,s.jsx)(t.h3,{id:"vite-configuration-file",children:"Vite configuration file"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"vite.config.ts"})," file is a regular configuration\nfile used by Vite. Per your project requirements, you can install and register\nadditional Vite plugins inside this file. By default, Vite file will use the\nAthenna plugin, which accepts the following options:"]}),"\n",(0,s.jsx)(t.h4,{id:"entrypoints",children:"entrypoints"}),"\n",(0,s.jsx)(t.p,{children:"The entrypoints refers to the entry point file of your frontend codebase.\nUsually, it will be a JavaScript or a TypeScript file with additional\nimports. Each entry point will result in a separate output bundle."}),"\n",(0,s.jsx)(t.p,{children:"Also, if needed, you can define multiple entrypoints. For example, an\nentry point for your user-facing app and another for the admin panel."}),"\n",(0,s.jsx)(t.h4,{id:"builddirectory",children:"buildDirectory"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"buildDirectory"})," option defines a relative path to the output\ndirectory. The option value is supplied to Vite as the ",(0,s.jsx)(t.code,{children:"build.outDir"})," option."]}),"\n",(0,s.jsxs)(t.p,{children:["If you decide to change the default value, make sure also to update the\n",(0,s.jsx)(t.code,{children:"buildDirectory"})," path in the ",(0,s.jsx)(t.code,{children:"vite"})," object inside ",(0,s.jsx)(a.A,{father:"config",child:"http.ts"}),"\nconfiguration file."]}),"\n",(0,s.jsxs)(t.p,{children:["Default: ",(0,s.jsx)(t.code,{children:"public/assets"})]}),"\n",(0,s.jsx)(t.h4,{id:"reload",children:"reload"}),"\n",(0,s.jsxs)(t.p,{children:["It contains an array of glob patterns to watch and reload the browser\non file change. By default, we watch for Edge templates in ",(0,s.jsx)(t.code,{children:"WEB EDGE"}),"\napplication and ",(0,s.jsx)(t.code,{children:".tsx"})," files on ",(0,s.jsx)(t.code,{children:"WEB REACT"}),". However, you can\nconfigure additional patterns as well."]}),"\n",(0,s.jsx)(t.h4,{id:"assetsurl",children:"assetsUrl"}),"\n",(0,s.jsx)(t.p,{children:"It contains the URL to prefix when generating links for assets in\nproduction. If you upload the Vite output to a CDN, then the value\nof this property should be the CDN server URL."}),"\n",(0,s.jsxs)(t.p,{children:["Ensure you update the backend configuration to use the same ",(0,s.jsx)(t.code,{children:"assetsUrl"}),"\nvalue."]}),"\n",(0,s.jsx)(t.h3,{id:"vite-backend-configuration",children:"Vite backend configuration"}),"\n",(0,s.jsx)(t.h4,{id:"dev",children:"dev"}),"\n",(0,s.jsxs)(t.p,{children:["Tell Athenna if should create vite development server or not.\nBy default, this is controlled by the ",(0,s.jsx)(t.code,{children:"Config.get('app.environment')"}),"\nconfiguration which points to the ",(0,s.jsx)(t.code,{children:"APP_ENV"})," environment variable\ndefined in your ",(0,s.jsx)(t.code,{children:".env"})," file."]}),"\n",(0,s.jsx)(t.h4,{id:"builddirectory-1",children:"buildDirectory"}),"\n",(0,s.jsxs)(t.p,{children:["It contains the path to the Vite's build output directory.\nYou must also update this backend config if you change the\ndefault value inside the ",(0,s.jsx)(t.code,{children:"vite.config.ts"})," file."]}),"\n",(0,s.jsx)(t.h4,{id:"assetsurl-1",children:"assetsUrl"}),"\n",(0,s.jsx)(t.p,{children:"The URL to prefix when generating links for assets in production.\nIf you upload the Vite output to a CDN, then the value of this\nproperty should be the CDN server URL."}),"\n",(0,s.jsx)(t.h4,{id:"scriptattributes",children:"scriptAttributes"}),"\n",(0,s.jsxs)(t.p,{children:["You can use the ",(0,s.jsx)(t.code,{children:"scriptAttributes"})," property to set attributes\non the script tags generated using the ",(0,s.jsx)(t.code,{children:"@vite"})," tag. The attributes\nare a collection of key-value pairs."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:"title=\"Path.config('http.ts')\"",children:"export default {\n  vite: {\n    scriptAttributes: {\n      defer: true,\n      async: true\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(t.h4,{id:"styleattributes",children:"styleAttributes"}),"\n",(0,s.jsxs)(t.p,{children:["You can use the ",(0,s.jsx)(t.code,{children:"styleAttributes"})," property to set attributes on\nthe link tags generated using the ",(0,s.jsx)(t.code,{children:"@vite"})," tag. The attributes\nare a collection of key-value pairs."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:"title=\"Path.config('http.ts')\"",children:"export default {\n  vite: {\n    styleAttributes: {\n      'data-turbo-track': 'reload'\n    }\n  }\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["You can also apply the attributes conditionally by assigning a\nfunction to the ",(0,s.jsx)(t.code,{children:"styleAttributes"})," option."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:"title=\"Path.config('http.ts')\"",children:"export default {\n  vite: {\n    styleAttributes: ({ src, url }) => {\n      if (src === 'src/resources/css/admin.css') {\n        return {\n          'data-turbo-track': 'reload'\n        }\n      }\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"starting-the-dev-server",children:"Starting the dev server"}),"\n",(0,s.jsxs)(t.p,{children:["You can start your application as usual, and Athenna will automatically\nproxy the needed requests to Vite if the ",(0,s.jsx)(t.code,{children:"dev"})," option is ",(0,s.jsx)(t.code,{children:"true"})," in your\nbackend vite configuration:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"node artisan serve\n"})}),"\n",(0,s.jsx)(t.h2,{id:"including-entrypoints-in-edge-templates",children:"Including entrypoints in Edge templates"}),"\n",(0,s.jsxs)(t.p,{children:["You can render the script and the style tags for the entrypoints defined\ninside the ",(0,s.jsx)(t.code,{children:"vite.config.ts"})," file using the ",(0,s.jsx)(t.code,{children:"@vite"})," Edge tag. The tag\naccepts an array of entrypoints and returns the script and the link tags."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-html",children:'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    @vite([\'src/resources/js/app.ts\'])\n</head>\n<body>\n    \n</body>\n</html>\n'})}),"\n",(0,s.jsx)(t.p,{children:"We recommend importing CSS files inside your TypeScript files and not\nregistering them separately as an entry point. For example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"src\n\u2514\u2500\u2500 resources\n    \u2514\u2500\u2500 css\n        \u2514\u2500\u2500 app.css\n    \u2514\u2500\u2500 js\n        \u2514\u2500\u2500 app.ts\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:'title="Path.resources("js/app.ts")"',children:"import '../css/app.css'\n"})}),"\n",(0,s.jsx)(t.h2,{id:"referencing-assets-inside-edge-templates",children:"Referencing assets inside Edge templates"}),"\n",(0,s.jsx)(t.p,{children:"Vite creates a dependency graph of files imported by the entrypoints\nand auto-updates their paths per the bundled output. However, Vite\nis unaware of Edge templates and cannot detect their referenced assets."}),"\n",(0,s.jsx)(t.p,{children:"Therefore, we provide an Edge helper you can use to create URLs for\nfiles processed by Vite. In the following example:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"asset"})," helper will return a URL pointing to the Vite dev server\nduring development."]}),"\n",(0,s.jsx)(t.li,{children:"Return a URL pointing to the output filename during production."}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-edge",children:'<link rel="stylesheet" href="{{ asset(\'src/resources/css/app.css\') }}">\n'})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-edge",metastring:'title="Output in development"',children:'<link rel="stylesheet" href="http://localhost:5173/src/resources/css/app.css">\n'})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-edge",metastring:'title="Output in production"',children:'<link rel="stylesheet" href="/public/assets/app-3bc29777.css">\n'})}),"\n",(0,s.jsx)(t.h2,{id:"processing-additional-assets-with-vite",children:"Processing additional assets with Vite"}),"\n",(0,s.jsx)(t.p,{children:"Vite ignores static assets not imported by the frontend code. It could\nbe static images, fonts, or SVG icons only referenced inside the Edge templates."}),"\n",(0,s.jsxs)(t.p,{children:["Therefore, you will have to notify Vite about the existence of these\nassets using its ",(0,s.jsx)(t.a,{href:"https://vite.dev/guide/features.html#glob-import",children:"Glob imports"})," API."]}),"\n",(0,s.jsxs)(t.p,{children:["In the following example, we ask Vite to process all the files within the\n",(0,s.jsx)(t.code,{children:"src/resources/img"})," directory. This code should be written within an entry point file:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import.meta.glob(['../img/**'])\n"})}),"\n",(0,s.jsx)(t.p,{children:"Now you can reference the images within your Edge templates as follows:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-edge",children:"<img src=\"{{ asset('src/resources/img/hero.jpg') }}\" />\n"})}),"\n",(0,s.jsx)(t.h2,{id:"enabling-hmr-with-react",children:"Enabling HMR with React"}),"\n",(0,s.jsxs)(t.p,{children:["To enable ",(0,s.jsx)(t.a,{href:"https://www.npmjs.com/package/react-refresh",children:"react-refresh"})," during\ndevelopment, you must use the ",(0,s.jsx)(t.code,{children:"@viteReactRefresh"})," Edge tag. It should be\nwritten before you include the entrypoints using the ",(0,s.jsx)(t.code,{children:"@vite"})," tag."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-edge",children:'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    @viteReactRefresh()\n    @vite([\'src/resources/js/app.ts\'])\n</head>\n<body>\n    \n</body>\n</html>\n'})}),"\n",(0,s.jsx)(t.p,{children:"Once done, you can configure the React plugin as usual in a regular Vite project."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import { defineConfig } from 'vite'\n\nimport react from '@vitejs/plugin-react'\nimport athenna from '@athenna/vite/plugins/client'\n\nexport default defineConfig({\n  plugins: [\n    athenna({\n      entrypoints: [\"src/resources/js/app.ts\"],\n    }),\n    react() \ud83d\udc48\n  ]\n})\n"})}),"\n",(0,s.jsxs)(t.admonition,{type:"tip",children:[(0,s.jsxs)(t.p,{children:["We highly recommend you to bootstrap a new project using Athenna CLI\nto select ",(0,s.jsx)(t.code,{children:"WEB REACT"})," application type. Will be easier if you start\nthis new project with everything configured then to try to do it manually,\njust run the following and select ",(0,s.jsx)(t.code,{children:"WEB REACT"})," when prompted:"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"athenna new my-react-app\n"})})]}),"\n",(0,s.jsx)(t.h2,{id:"deploying-assets-to-a-cdn",children:"Deploying assets to a CDN"}),"\n",(0,s.jsx)(t.p,{children:"After you create the production build using Vite, you can upload\nthe bundled output to a CDN server to serve the files."}),"\n",(0,s.jsxs)(t.p,{children:["However, before you do that, you must register the URL of your\nCDN server with both Vite and Athenna so that the output URLs\ninside the ",(0,s.jsx)(t.code,{children:"manifest.json"})," file or lazy loaded chunks should\npoint to your CDN server."]}),"\n",(0,s.jsxs)(t.p,{children:["You must define the ",(0,s.jsx)(t.code,{children:"assetsUrl"})," inside the ",(0,s.jsx)(t.code,{children:"vite.config.ts"}),"\nfile and in ",(0,s.jsx)(t.code,{children:"vite"})," object of ",(0,s.jsx)(a.A,{father:"config",child:"http.ts"}),"\nfile."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:'title="vite.config.ts"',children:"import { defineConfig } from 'vite'\nimport athenna from '@athenna/vite/plugins/client'\n\nexport default defineConfig({\n  plugins: [\n    athenna({\n      entrypoints: ['src/resources/js/app.ts'],\n      reloads: ['src/resources/views/**/*.edge'],\n      assetsUrl: 'https://cdn.example.com/',\n    }),\n  ]\n})\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:'title="Path.config("http.ts")"',children:"export default {\n  vite: {\n    buildDirectory: 'public/assets',\n    assetsUrl: 'https://cdn.example.com/'\n  }\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"manifest-file",children:"Manifest file"}),"\n",(0,s.jsx)(t.p,{children:"Vite generates the manifest file alongside the production build\nof your assets."}),"\n",(0,s.jsxs)(t.p,{children:["The manifest file contains the URLs to the assets processed by Vite,\nand Athenna uses this file to create URLs for assets referenced\ninside the Edge templates either using the ",(0,s.jsx)(t.code,{children:"asset"})," helper or the ",(0,s.jsx)(t.code,{children:"@vite"}),"\ntag."]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},7049:(e,t,n)=>{n.d(t,{A:()=>r});n(6540);const i={hoverCardContainer:"hoverCardContainer_jqUQ",hoverCardLink:"hoverCardLink_oDZU",hoverCard:"hoverCard_qTDS"};var s=n(4848);function r(e){let t=e.father;switch(e.father){case"storage":t="src/storage";break;case"logs":t="src/storage/logs";break;case"views":t="src/resources/views";break;case"locales":t="src/resources/locales";break;case"static":t="src/resources/static";break;case"config":t="src/config";break;case"database":t="src/database";break;case"seeders":t="src/database/seeders";break;case"migrations":t="src/database/migrations";break;case"console":t="src/console";break;case"commands":t="src/console/commands";break;case"cron":t="src/cron";break;case"schedulers":t="src/cron/schedulers";break;case"models":t="src/models";break;case"services":t="src/services";break;case"repositories":t="src/repositories";break;case"http":t="src/http";break;case"controllers":t="src/http/controllers";break;case"middlewares":t="src/http/middlewares";break;case"interceptors":t="src/http/interceptors";break;case"terminators":t="src/http/terminators";break;case"stubs":t="tests/stubs";break;case"fixtures":t="tests/fixtures";break;case"providers":t="src/providers";break;case"facades":t="src/facades";break;case"routes":t="src/routes";break;case"validators":t="src/validators"}return(0,s.jsxs)("div",{className:i.hoverCardContainer,children:[(0,s.jsx)("a",{className:i.hoverCardLink,href:`/docs/the-basics/helpers#path${e.father}`,children:(0,s.jsxs)("code",{children:["Path.",e.father,"(",e.child?`'${e.child}'`:"",")"]})}),(0,s.jsx)("div",{className:i.hoverCard,children:(0,s.jsxs)("p",{style:{margin:0},children:["./",t,e.child?`/${e.child}`:""]})})]})}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var i=n(6540);const s={},r=i.createContext(s);function a(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);