"use strict";(self.webpackChunk_athenna_docs=self.webpackChunk_athenna_docs||[]).push([[4246],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return g}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),g=a,f=p["".concat(s,".").concat(g)]||p[g]||d[g]||i;return n?r.createElement(f,o(o({ref:t},c),{},{components:n})):r.createElement(f,o({ref:t},c))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var u=2;u<i;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},3179:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return s},default:function(){return p},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return c}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],l={sidebar_position:5,id:"graceful-shutdown",title:"Graceful Shutdown",hide_title:!0,hide_table_of_contents:!0,tags:["Http","Graceful Shutdown","Digging Deeper"]},s=void 0,u={unversionedId:"digging-deeper/graceful-shutdown",id:"digging-deeper/graceful-shutdown",title:"Graceful Shutdown",description:"\ud83c\udfe0",source:"@site/docs/digging-deeper/graceful-shutdown.mdx",sourceDirName:"digging-deeper",slug:"/digging-deeper/graceful-shutdown",permalink:"/docs/digging-deeper/graceful-shutdown",editUrl:"https://github.com/AthennaIO/Docs/docs/digging-deeper/graceful-shutdown.mdx",tags:[{label:"Http",permalink:"/docs/tags/http"},{label:"Graceful Shutdown",permalink:"/docs/tags/graceful-shutdown"},{label:"Digging Deeper",permalink:"/docs/tags/digging-deeper"}],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,id:"graceful-shutdown",title:"Graceful Shutdown",hide_title:!0,hide_table_of_contents:!0,tags:["Http","Graceful Shutdown","Digging Deeper"]},sidebar:"tutorialSidebar",previous:{title:"Rate Limiting",permalink:"/docs/digging-deeper/rate-limiting"},next:{title:"Documenting with Swagger",permalink:"/docs/digging-deeper/swagger"}},c=[{value:"Introduction",id:"id-introduction",children:[],level:2},{value:"Configurations",id:"id-configuration",children:[],level:2},{value:"Disabling graceful shutdown",id:"id-disabling-graceful-shutdown",children:[],level:2}],d={toc:c};function p(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("nav",{"aria-label":"breadcrumbs"},(0,i.kt)("ul",{class:"breadcrumbs"},(0,i.kt)("li",{class:"breadcrumbs__item"},(0,i.kt)("a",{class:"breadcrumbs__link",href:"/"},"\ud83c\udfe0")),(0,i.kt)("li",{class:"breadcrumbs__item"},(0,i.kt)("a",{class:"breadcrumbs__link"},"Digging Deeper")),(0,i.kt)("li",{class:"breadcrumbs__item"},(0,i.kt)("a",{class:"breadcrumbs__link",href:"/docs/digging-deeper/graceful-shutdown"},"Graceful Shutdown")))),(0,i.kt)("span",{class:"badge badge--secondary margin-top-bot"},"version 1.0.0"),(0,i.kt)("h1",{id:"graceful-shutdown"},"Graceful Shutdown"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("h4",{parentName:"li",id:"introduction"},(0,i.kt)("a",{parentName:"h4",href:"#id-introduction"},"Introduction"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("h4",{parentName:"li",id:"configurations"},(0,i.kt)("a",{parentName:"h4",href:"#id-configurations"},"Configurations"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("h4",{parentName:"li",id:"disabling-graceful-shutdown"},(0,i.kt)("a",{parentName:"h4",href:"#id-disabling-graceful-shutdown"},"Disabling graceful shutdown")))),(0,i.kt)("h2",{id:"id-introduction"},"Introduction"),(0,i.kt)("p",null,"Graceful shutdown means that the OS (operating system) can safely shut down its processes and close all connections, however long that takes.\nThis helps to prevent accidental data loss or other unexpected problems if the shutdown is performed intentionally by the user."),(0,i.kt)("h2",{id:"id-configuration"},"Configurations"),(0,i.kt)("p",null,"Athenna already comes with graceful shutdown configured by default using the ",(0,i.kt)("inlineCode",{parentName:"p"},"gracefulShutdown")," object in ",(0,i.kt)("inlineCode",{parentName:"p"},"config/app.js")," file. In this\nobject you can configure all ",(0,i.kt)("a",{parentName:"p",href:"https://www.geeksforgeeks.org/node-js-process-signal-events/"},(0,i.kt)("inlineCode",{parentName:"a"},"SIGNALS"))," that Node.js process will listen for in your application. Athenna comes with ",(0,i.kt)("inlineCode",{parentName:"p"},"SIGINT")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"SIGTERM"),"\nalready configured by default:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"import { ProviderHelper } from '@athenna/core'\n\ngracefulShutdown: {\n    SIGINT: async () => {\n      await ProviderHelper.shutdownAll(false)\n\n      process.exit()\n    },\n    SIGTERM: async signal => {\n      await ProviderHelper.shutdownAll()\n\n      process.kill(process.pid, signal)\n    },\n},\n")),(0,i.kt)("p",null,"It's imperative that you always call the ",(0,i.kt)("inlineCode",{parentName:"p"},"ProviderHelper.shutdownAll()")," method in your signals configurations. This method is who will\ncall the ",(0,i.kt)("inlineCode",{parentName:"p"},"shutdown")," method of Athenna providers."),(0,i.kt)("h2",{id:"id-disabling-graceful-shutdown"},"Disabling graceful shutdown"),(0,i.kt)("p",null,"To disable the graceful shutdown of some SIGNAL you can just remove it from ",(0,i.kt)("inlineCode",{parentName:"p"},"gracefulShutdown")," object in ",(0,i.kt)("inlineCode",{parentName:"p"},"config/app.js"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"gracefulShutdown: {}\n")))}p.isMDXComponent=!0}}]);