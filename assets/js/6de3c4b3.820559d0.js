"use strict";(self.webpackChunk_athenna_docs=self.webpackChunk_athenna_docs||[]).push([[5502],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return u}});var i=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,i,r=function(e,t){if(null==e)return{};var a,i,r={},n=Object.keys(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=i.createContext({}),d=function(e){var t=i.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=d(e.components);return i.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var a=e.components,r=e.mdxType,n=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),p=d(a),u=r,h=p["".concat(s,".").concat(u)]||p[u]||c[u]||n;return a?i.createElement(h,o(o({ref:t},m),{},{components:a})):i.createElement(h,o({ref:t},m))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var n=a.length,o=new Array(n);o[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var d=2;d<n;d++)o[d]=a[d];return i.createElement.apply(null,o)}return i.createElement.apply(null,a)}p.displayName="MDXCreateElement"},338:function(e,t,a){a.r(t),a.d(t,{contentTitle:function(){return s},default:function(){return p},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return m}});var i=a(7462),r=a(3366),n=(a(7294),a(3905)),o=["components"],l={sidebar_position:2,id:"criterias",title:"Criterias",hide_title:!0,hide_table_of_contents:!0,tags:["ORM","Database","Criterias"]},s=void 0,d={unversionedId:"orm/criterias",id:"orm/criterias",title:"Criterias",description:"\ud83c\udfe0",source:"@site/docs/orm/criterias.mdx",sourceDirName:"orm",slug:"/orm/criterias",permalink:"/docs/orm/criterias",editUrl:"https://github.com/AthennaIO/Docs/docs/orm/criterias.mdx",tags:[{label:"ORM",permalink:"/docs/tags/orm"},{label:"Database",permalink:"/docs/tags/database"},{label:"Criterias",permalink:"/docs/tags/criterias"}],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,id:"criterias",title:"Criterias",hide_title:!0,hide_table_of_contents:!0,tags:["ORM","Database","Criterias"]},sidebar:"tutorialSidebar",previous:{title:"Getting Started",permalink:"/docs/orm/getting-started"},next:{title:"Relationships",permalink:"/docs/orm/relationships"}},m=[{value:"Introduction",id:"id-introduction",children:[],level:2},{value:"Setting criterias in models",id:"id-setting-criterias-in-models",children:[],level:2},{value:"Removing criterias from model",id:"id-removing-criterias",children:[{value:"Removing criterias from model query builder",id:"id-removing-criterias-from-model-query-builder",children:[],level:3}],level:2},{value:"Listing all available criterias",id:"id-listing-all-available-criterias",children:[],level:2}],c={toc:m};function p(e){var t=e.components,a=(0,r.Z)(e,o);return(0,n.kt)("wrapper",(0,i.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("nav",{"aria-label":"breadcrumbs"},(0,n.kt)("ul",{class:"breadcrumbs"},(0,n.kt)("li",{class:"breadcrumbs__item"},(0,n.kt)("a",{class:"breadcrumbs__link",href:"/"},"\ud83c\udfe0")),(0,n.kt)("li",{class:"breadcrumbs__item"},(0,n.kt)("a",{class:"breadcrumbs__link"},"ORM")),(0,n.kt)("li",{class:"breadcrumbs__item"},(0,n.kt)("a",{class:"breadcrumbs__link",href:"/docs/orm/criterias"},"Criterias")))),(0,n.kt)("span",{class:"badge badge--secondary margin-top-bot"},"version 1.0.0"),(0,n.kt)("h1",{id:"orm-criterias"},"ORM: Criterias"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("h4",{parentName:"li",id:"introduction"},(0,n.kt)("a",{parentName:"h4",href:"#id-introduction"},"Introduction"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("h4",{parentName:"li",id:"setting-criterias-in-models"},(0,n.kt)("a",{parentName:"h4",href:"#id-setting-criterias-in-models"},"Setting criterias in models"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("h4",{parentName:"li",id:"removing-criterias-from-models"},(0,n.kt)("a",{parentName:"h4",href:"#id-removing-criterias-from-models"},"Removing criterias from models")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("h4",{parentName:"li",id:"removing-criterias-from-model-query-builder"},(0,n.kt)("a",{parentName:"h4",href:"#id-removing-criterias-from-model-query-builder"},"Removing criterias from model query builder"))))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("h4",{parentName:"li",id:"listing-all-available-criterias"},(0,n.kt)("a",{parentName:"h4",href:"#id-listing-all-available-criterias"},"Listing all available criterias")))),(0,n.kt)("h2",{id:"id-introduction"},"Introduction"),(0,n.kt)("p",null,'Criterias allow you to add constraints to all queries for a given model. Athenna\'s own soft delete functionality utilizes criterias to only retrieve\n"non-deleted" models from the database. Writing your own criterias can provide a convenient, easy way to make sure every query for a given model receives\ncertain constraints.'),(0,n.kt)("h2",{id:"id-setting-criterias-in-models"},"Setting criterias in models"),(0,n.kt)("p",null,"Setting a criteria is very simple. You can do it by two ways, first by defining a ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/AthennaIO/Database/blob/develop/src/Models/Criteria.js"},(0,n.kt)("inlineCode",{parentName:"a"},"Criteria"))," in your model:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"import { Model, Criteria } from '@athenna/database'\n\nexport class User extends Model {\n  static get criterias() {\n    return {\n        myCriteriaName: Criteria.select('id', 'name').orderBy('name', 'DESC').get()\n    }\n  }\n\n  /*...*/\n}\n")),(0,n.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"The ",(0,n.kt)("inlineCode",{parentName:"p"},"get")," method in the final of the ",(0,n.kt)("inlineCode",{parentName:"p"},"Criteria"),' class is very important to "create" your criteria object. Remember always calling this method when using\ncriterias in the static method ',(0,n.kt)("inlineCode",{parentName:"p"},"criterias")," in your models."))),(0,n.kt)("p",null,"The second way to define a criteria is calling the ",(0,n.kt)("inlineCode",{parentName:"p"},"addCriteria")," method from your model:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"User.addCriteria('myCriteriaName', Criteria.select('id', 'name').orderBy('name', 'DESC'))\n")),(0,n.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"The ",(0,n.kt)("inlineCode",{parentName:"p"},"addCriteria")," method will automatically recognize if you have called the ",(0,n.kt)("inlineCode",{parentName:"p"},"get")," method or not. So when using ",(0,n.kt)("inlineCode",{parentName:"p"},"addCriteria")," method you don't need\nto call the ",(0,n.kt)("inlineCode",{parentName:"p"},"get")," method. But you can do so if you want:"),(0,n.kt)("pre",{parentName:"div"},(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"User.addCriteria('myCriteriaName', Criteria.select('id', 'name').orderBy('name', 'DESC').get())\n")))),(0,n.kt)("h2",{id:"id-removing-criterias"},"Removing criterias from model"),(0,n.kt)("p",null,"All the criterias add using the ",(0,n.kt)("inlineCode",{parentName:"p"},"addCriteria")," method can be removed by using the ",(0,n.kt)("inlineCode",{parentName:"p"},"removeCriteria")," method:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"User.removeCriteria('myCriteriaName')\n")),(0,n.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"The criterias that has been set in your static ",(0,n.kt)("inlineCode",{parentName:"p"},"criterias")," method can only be removed using the ",(0,n.kt)("inlineCode",{parentName:"p"},"removeCriteria")," from your model query builder. Check the\ndocumentation bellow to understand this behavior."))),(0,n.kt)("h3",{id:"id-removing-criterias-from-model-query-builder"},"Removing criterias from model query builder"),(0,n.kt)("p",null,"As you can see, the ",(0,n.kt)("inlineCode",{parentName:"p"},"criterias")," method from your model is static. This means that if you call ",(0,n.kt)("inlineCode",{parentName:"p"},"addCriteria")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"removeCriteria")," it will change the state of\nyour model globally in your application run time. To cover this behavior, the Athenna ",(0,n.kt)("inlineCode",{parentName:"p"},"ModelQueryBuilder")," makes a copy of all the ",(0,n.kt)("inlineCode",{parentName:"p"},"criterias")," in your model\nwhen you use the ",(0,n.kt)("inlineCode",{parentName:"p"},"query")," method. So, if you call the ",(0,n.kt)("inlineCode",{parentName:"p"},"removeCriteria")," of the model query builder, it will be removed only for that particular query builder\ninstance and not globally from your models:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"const user = await User.query()\n        .removeCriteria('myCriteriaName')\n        .where('name', 'Valmir Barbosa')\n        .findMany()\n")),(0,n.kt)("p",null,'You cannot add criterias again to your query at this point. So if you wish to "rollback" your criteria removal you will need to create a new query:'),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"const user = await User.query()\n        .where('name', 'Valmir Barbosa')\n        .findMany()\n")),(0,n.kt)("h2",{id:"id-listing-all-available-criterias"},"Listing all available criterias"),(0,n.kt)("p",null,"You can list all the criterias available in you model using the ",(0,n.kt)("inlineCode",{parentName:"p"},"getCriterias")," method. This method will merge both criterias set in static ",(0,n.kt)("inlineCode",{parentName:"p"},"criterias")," method\nand criterias set using the ",(0,n.kt)("inlineCode",{parentName:"p"},"addCriterias")," method:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"const criterias = User.getCriterias()\n")),(0,n.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"Always remember that basically any method (excluding the executors method like ",(0,n.kt)("inlineCode",{parentName:"p"},"create"),") that are available in your\nmodels query builder (",(0,n.kt)("a",{parentName:"p",href:"/docs/orm/getting-started#id-building-queries"},(0,n.kt)("inlineCode",{parentName:"a"},"ModelQueryBuilder")),") can be used by your criterias."))))}p.isMDXComponent=!0}}]);