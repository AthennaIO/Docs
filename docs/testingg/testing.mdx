---
sidebar_position: 1

id: getting-started
title: Getting Started
hide_title: true
hide_table_of_contents: true
tags:
- Testing
---

<nav aria-label="breadcrumbs">
    <ul class="breadcrumbs">
        <li class="breadcrumbs__item">
            <a class="breadcrumbs__link" href="/">üè†</a>
        </li>
        <li class="breadcrumbs__item">
            <a class="breadcrumbs__link">Testing</a>
        </li>
        <li class="breadcrumbs__item">
            <a class="breadcrumbs__link" href="/docs/testingg/getting-started">Testing: Getting Started</a>
        </li>
    </ul>
</nav>

<span class="badge badge--secondary margin-top-bot">version 1.0.0</span>


# Testing: Getting Started

- #### [Introduction](#id-introduction)
- #### [Environment](#id-environment)
- #### [Creating tests](#id-creating-tests)
- #### [Running tests](#id-running-tests)
    - #### [Reporting tests coverage](#id-reporting-tests-coverage)

## Introduction {#id-introduction}

Athenna is built with testing in mind. In fact, support for testing with [`Japa`](https://japa.dev/) is included out of the box and a `main.js`
file is already set up for your application. The framework also ships with convenient helper methods that allow you to
expressively test your applications.

By default, your application's `tests` directory contains two directories: `E2E` and `Unit`. Unit tests are tests that
focus on a very small, isolated portion of your code. In fact, most unit tests probably focus on a single method. Tests
within your "Unit" test directory do not boot your Athenna application and therefore are unable to access your application's
database or other framework services.

E2E tests may test a larger portion of your code, including how several objects interact with each other or even a full
HTTP request to a JSON endpoint. Generally, most of your tests should be feature tests. These types of tests provide the
most confidence that your system as a whole is functioning as intended.

When you scaffold a new Athenna project it will come with two tests implemented. One is inside E2E folder, the `WelcomeTest.js` file.
And the other is the `WelcomeServiceTest.js` file that is inside Unit folder. Use the `npm test` command to run your tests.

## Environment {#id-environment}

When running tests, Athenna will automatically set the configuration environment (NODE_ENV) to testing. You are free to
define other testing environment configuration values as necessary. The testing environment variables may be configured
in your application's `main.js` file, or you can simply create a `.env.testing` file in the root of your application.

## Creating tests {#id-creating-tests}

To create a new test case, use the `make:test` Artisan command. By default, tests will be placed in the `tests/E2E` directory:

```shell
node artisan make:test UserTest
```

If you would like to create a test within the `tests/Unit` directory, you may use the `--unit` option when executing the `make:test` command:

```shell
node artisan make:test UserTest --unit
```

Once the test has been generated, you may define your tests as you normally would using [`Japa`](https://japa.dev/). To run your tests,
execute the `npm start` or `node artisan test` command from your terminal:

```javascript
import { Test } from '@athenna/test'

export class ExampleTest extends Test {
    /**
     * Before all event. This method is executed
     * before all tests.
     *
     * @return {void | Promise<void>}
     */
    async beforeAll() {}

    /**
     * Before each event. This method is executed
     * before each test.
     *
     * @return {void | Promise<void>}
     */
    async beforeEach() {}

    /**
     * After all event. This method is executed
     * after all tests.
     *
     * @return {void | Promise<void>}
     */
    async afterAll() {}

    /**
     * After each event. This method is executed
     * after each test.
     *
     * @return {void | Promise<void>}
     */
    async afterEach() {}

    /**
     * Set the test timeout for all tests inside the group.
     *
     * @example
     *  Default is 2000
     *
     * @return {number}
     */
    get timeout() {
        return 2000
    }

    /**
     * Set the test names that can run.
     *
     * @example
     *  Default is ['*']
     *
     * @return {string[]}
     */
    get runOnly() {
        return ['shouldBeAbleToRunTests']
    }

    /**
     * Run your test.
     *
     * @param {import('#src/index').HttpTestContext} ctx
     */
    async shouldBeAbleToRunTests({ assert }) {
        assert.equal(2 + 2, 4)
    }
}
```

:::caution

Any method/attribute defined in your test class will be considered a test. To get around this you just need to define
your method/attribute with an `_` in front of it. Example: `_getMyProductId()`

:::

## Running tests {#id-running-tests}

In addition to the `npm test` command, you may use the `test` Artisan command to run your tests. The Artisan test runner provides
verbose test reports in order to ease development and debugging:

```shell
node artisan test
```

Any arguments that can be passed to the [`Japa`](https://japa.dev/) command may also be passed to the Artisan test command:

```shell
node artisan test Unit
```

But you can use the artisan options instead:

```shell
node artisan test --e2e --unit
```

### Reporting tests coverage {#id-reporting-tests-coverage}

:::caution

This feature requires the [`c8`](https://www.npmjs.com/package/c8) library.

:::

When running your application tests, you may want to determine whether your test cases are actually covering the application
code and how much application code is used when running your tests. To accomplish this, you may provide the `c8` cli when invoking
the test command:

```shell
c8 node artisan test
```

To define a minimum test coverage threshold for your application you can use the `"c8"` property inside `package.json` file.
The test suite will fail if this threshold is not met. By default, Athenna comes with 70% of coverage in all type of coverages:

```shell
"c8": {
    "all": true,
    "include": [
      "app/**/*.js"
    ],
    "reporter": [
      "text-summary",
      "html"
    ],
    "report-dir": "./tests/Coverage",
    "check-coverage": true,
    "statements": "70", # <-
    "branches": "70", # <-
    "functions": "70", # <-
    "lines": "70" # <-
},
```
