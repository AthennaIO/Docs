---
sidebar_position: 6

id: extending-models
title: Extending Models
hide_title: true
hide_table_of_contents: true
tags:
- ORM
- Database
- Extending Models
---

<nav aria-label="breadcrumbs">
    <ul class="breadcrumbs">
        <li class="breadcrumbs__item">
            <a class="breadcrumbs__link" href="/">ğŸ </a>
        </li>
        <li class="breadcrumbs__item">
            <a class="breadcrumbs__link">ORM</a>
        </li>
        <li class="breadcrumbs__item">
            <a class="breadcrumbs__link" href="/docs/orm/extending-models">Extending Models</a>
        </li>
    </ul>
</nav>

<span class="badge badge--secondary margin-top-bot">version 1.0.0</span>

# ORM: Extending Models

- #### [Introduction](#id-introduction)
- #### [Writing static methods](#id-writing-static-methods)
- #### [Writing instance methods](#id-writing-instance-methods)

## Introduction {#id-introduction}

All the Athenna models extends the `Model` class of the `@athenna/database` package. This class provides everything that a model needs to communicate with database in the best
way possible. But sometimes you may need to write your own methods depending on your business logic and to save some time. You will see at this page how you can easily
create your own static and instance methods for your models.

## Writing static methods {#id-writing-static-methods}

Let's start by defining a new static method in our `User` model that will retrieve a user and also load relationships:

```javascript
import { Model } from '@athenna/database'

export class User extends Model {
  static async findWith(relationName, where = {}) {
      const query = this.query().with(relationName)

      // Verify if the where object is not
      // empty to apply it in the query.
      if (Object.keys(where).length) {
          query.where(where)
      }

      return this.query().with(relationName).find()
  }

  /*...*/
}
```

Now we can start finding our user with his relations with a little less code:

```javascript
const user = await User.findWith('posts.comments', { id: 1 })
```

Let's implement another method that will get all the users that were created in the last 15 minutes ordering then by name:

```javascript
import { Model } from '@athenna/database'

export class User extends Model {
  static async getRecentlyCreatedUsers() {
      const nowDate = new Date()
      const nowDateLessFifteenMinutes = new Date(nowDate - 15 * 60000)

      return this.query()
        .whereBetween('createdAt', [nowDate, nowDateLessFifteenMinutes])
        .findMany()
  }

  /*...*/
}
```

Calling our new static method:

```javascript
const recentlyUsers = await User.getRecentlyCreatedUsers()
```

## Writing instance methods {#id-writing-instance-methods}

You can also implement your own instance methods for your models. Let's implement a new instance method that will confirm the user email:

```javascript
import { Model } from '@athenna/database'

export class User extends Model {
   async confirmEmailNow() {
     this.emailVerifiedAt = new Date()

     await this.save()
   }

  /*...*/
}
```

Now we can easily confirm the user email with one method call:

```javascript
const user = await User.find()

await user.confirmEmailNow()
```

Now let's implement a method that will load the user posts if they are not loaded and also get the oldest post of the user:

```javascript
import { Model } from '@athenna/database'

export class User extends Model {
   async getOldestPost() {
     if (!this.posts) {
         await this.load('posts', query => query.oldest())
     }

     return this.posts[0]
   }

  /*...*/
}
```

Using our new method:

```javascript
const user = await User.find()
const oldestPost = await user.getOldestPost()
```

:::tip
Always be carefully to not break the single responsibility principle of [`SOLID`](https://medium.com/backticks-tildes/the-s-o-l-i-d-principles-in-pictures-b34ce2f1e898) when
implementing your own model methods. But you are free to do whatever you want with Athenna ğŸ˜ğŸ¤™. All this methods implementation will always depend on your business logic and
creativity.
:::
